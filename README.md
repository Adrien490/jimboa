# üéÆ Jimbao

**Un jeu social quotidien pour groupes priv√©s**

[![Website](https://img.shields.io/badge/Website-jimbao.fr-blue)](https://jimbao.fr)
[![Status](https://img.shields.io/badge/Status-En%20d√©veloppement-yellow)]()

> Jimboa propose un prompt quotidien (question, vote, challenge) √† un groupe priv√©. Chaque membre peut publier imm√©diatement texte/m√©dia, commenter, r√©agir et voter. √Ä la fermeture, la manche est archiv√©e et reste consultable par le groupe.

---

## üìã Table des mati√®res

- [üéØ Vision & Concept](#-vision--concept)
- [üë• Proposition de valeur](#-proposition-de-valeur--personas)
- [üé≤ R√®gles du jeu](#-r√®gles-de-jeu--boucle-quotidienne)
- [‚ú® Fonctionnalit√©s cl√©s](#-fonctionnalit√©s-cl√©s-p√©rim√®tre-v1)
- [üóÑÔ∏è Mod√®le de donn√©es](#Ô∏è-mod√®le-de-donn√©es-erd)
- [üîî Notifications](#-notifications--pr√©f√©rences)
- [üìù User Stories](#-user-stories-backlog)
- [‚öôÔ∏è Workflow d'orchestration](#Ô∏è-workflow-dorchestration-jobs)
- [üé® Parcours UX](#-parcours-ux-prioritaires)
- [üóìÔ∏è Roadmap](#Ô∏è-roadmap--jalons)
- [‚ö†Ô∏è Risques & Garde-fous](#Ô∏è-risques--garde-fous)
- [üìñ Glossaire](#-glossaire)

## üéØ Vision & Concept

**Jimboa** transforme la routine quotidienne en moment de connexion sociale √† travers des prompts engageants.

### üåü Positionnement

- **L√©ger** : Rituel simple de 5-10 minutes par jour
- **Intime** : Groupes priv√©s (amis proches, couples)
- **Fun** : Prompts vari√©s et interactions spontan√©es
- **Sans pression** : Pas de classement global ni de m√©triques intrusives

### üé™ Concept central

Chaque jour, un prompt unique (question, vote, challenge) est propos√© au groupe. Les membres participent librement avec du texte/m√©dia, commentent et r√©agissent en temps r√©el. √Ä la fermeture, la manche est archiv√©e et reste consultable avec tout son contenu.

## üë• Proposition de valeur & Personas

### üéØ Personas cibles

#### üë´ Amis proches

- **Besoin** : Garder le lien au quotidien avec un rituel simple et amusant
- **Contexte** : Vies charg√©es, envie de maintenir la proximit√© sans contrainte

#### üíë Couples

- **Besoin** : Entretenir complicit√© et conversation l√©g√®re sans pression
- **Contexte** : Routine quotidienne, recherche de nouveaux sujets de discussion

### üé™ Jobs-to-be-done

> _"Je veux un micro-rituel social quotidien qui ne demande pas d'organisation."_

> _"Je veux des sujets qui nous ressemblent, sans bruit ni algorithmes opaques."_

## üé≤ R√®gles de jeu & Boucle quotidienne

### ‚è∞ Cycle quotidien

```mermaid
graph LR
    A[üìÖ Planification] --> B[üîî Ouverture + Notif]
    B --> C[‚úçÔ∏è Participation]
    C --> D[üí¨ Interactions]
    D --> E[üó≥Ô∏è Vote si applicable]
    E --> F[‚è∞ Rappel]
    F --> G[üîí Fermeture]
    G --> H[üìö Archive consultable]
```

### üìã R√®gles fondamentales

1. **Planification** : Heure locale du groupe
2. **Ouverture** : Notification automatique √† tous les membres
3. **Participation** : Soumissions visibles imm√©diatement (pas de mode "blind")
4. **Interactions** : Commentaires et votes visibles apr√®s avoir soumis sa r√©ponse
5. **Vote** : Si type="vote", 1 vote par personne maximum
6. **Rappel** : Notification avant fermeture (opt-in)
7. **Fermeture** : Archivage automatique ‚Üí consultation en lecture seule

## ‚ú® Fonctionnalit√©s cl√©s (P√©rim√®tre v1)

### üë• Gestion des groupes

- **Types** : `friends` ou `couple`
- **R√¥les** : `owner` unique / `admin` / `member`
- **Invitations** : Code permanent modifiable, g√©n√©r√© automatiquement
- **Image de profil** : Avatar personnalisable pour chaque groupe
- **Authentification** : Google OAuth uniquement
- **Configuration** : Email du cr√©ateur d√©fini via `APP_CREATOR_EMAIL` dans .env

### üéØ Syst√®me de prompts hybride

- **Banque globale curat√©e** : Starter pack de prompts approuv√©s pour tous les groupes
- **Prompts locaux** : Owners/admins peuvent cr√©er des prompts sp√©cifiques √† leur groupe
- **Syst√®me de suggestions** : Proposer des prompts locaux r√©ussis vers la banque globale
- **Contributions communautaires** : Sugg√©rer des prompts locaux r√©ussis pour la banque globale
- **Types** : Question, Vote, Challenge (global et local)
- **Workflow global** : Pending ‚Üí Approved/Rejected ‚Üí Archived
- **Workflow local** : Cr√©ation directe par owner/admin, √©dition libre
- **Tagging & filtrage** : Classification par tags, langue, difficult√©
- **S√©lection** : Automatique (globaux + locaux) ou manuelle par groupe

### üí¨ Interactions sociales

- **Soumissions** : Texte + m√©dias, 1 par user/manche, visibles uniquement apr√®s avoir soumis, pas d'√©dition
- **Suppression** : Possible pendant la fen√™tre ouverte (lib√®re le quota pour re-soumission)
- **Commentaires** : Discussion globale sous chaque question du jour (visible apr√®s avoir soumis)
- **Votes** : 1 vote par manche (type "vote" uniquement)
- **Visibilit√© conditionnelle** : Soumissions, discussion et votes visibles uniquement apr√®s avoir soumis sa r√©ponse

### üîî Notifications intelligentes

- **Ouverture** : Nouveau prompt disponible
- **Rappel** : Avant fermeture (personnalisable)
- **Pr√©f√©rences** : Par utilisateur et par groupe

### üìö Consultation des manches

- **Archives** : Toutes les manches ferm√©es restent consultables
- **Pas de scoring** : Focus sur le partage et l'interaction
- **Lecture seule** : Aucune interaction possible sur les manches ferm√©es

### üõ°Ô∏è Gestion des prompts

#### üåç Prompts globaux (curat√©s)

- **Acc√®s exclusif** : Seul le cr√©ateur de l'app peut parcourir et g√©rer la banque globale
- **Starter pack** : Collection initiale de prompts approuv√©s par le cr√©ateur
- **Contributions** : Suggestions issues des meilleurs prompts locaux (via suggestions)
- **Mod√©ration centralis√©e** : App creator valide les ajouts √† la banque globale
- **Interface d'admin** : Dashboard exclusif au cr√©ateur pour g√©rer la banque globale
- **Qualit√© √©ditoriale** : Coh√©rence, universalit√©, respect des valeurs

#### üè† Prompts locaux (libert√© cr√©ative)

- **Acc√®s restreint** : Seuls les owners/admins peuvent parcourir et g√©rer la banque locale de leur groupe
- **Cr√©ation libre** : Owners/admins cr√©ent directement pour leur groupe
- **Pas de clonage direct** : Les prompts globaux ne sont plus directement clonables (acc√®s restreint)
- **√âv√©nements priv√©s** : Prompts sp√©cifiques (anniversaires, blagues internes)
- **Langues locales** : Adaptation linguistique et culturelle
- **Pas de mod√©ration** : Libert√© totale dans le cadre du groupe

## üóÑÔ∏è Mod√®le de donn√©es (ERD)

### üîó Relations principales

```mermaid
erDiagram
    profiles ||--o{ group_members : "membre de"
    groups ||--|| group_settings : "param√®tres"
    groups ||--o{ group_members : "contient"
    groups ||--o{ daily_rounds : "manches"
    groups ||--o{ group_prompts : "prompts locaux"
    global_prompts ||--o{ daily_rounds : "utilis√© dans round"
    group_prompts ||--o{ daily_rounds : "utilis√© dans round"
    global_prompts ||--o{ group_prompts : "clon√© depuis"
    group_prompts ||--o{ prompt_suggestions : "sugg√©r√© vers global"
    profiles ||--o{ prompt_suggestions : "sugg√®re"
    profiles ||--o{ global_prompts : "cr√©ateur/mod√©rateur"
    profiles ||--o{ group_prompts : "cr√©ateur local"
    daily_rounds ||--o{ submissions : "soumissions"
    daily_rounds ||--o{ round_votes : "votes"
    profiles ||--o{ submissions : "auteur"
    profiles ||--o{ comments : "commentaire"
    profiles ||--o{ reactions : "r√©action"
    profiles ||--o{ round_votes : "voteur"
    daily_rounds ||--o{ comments : "discussion globale"
    submissions ||--o{ submission_media : "m√©dias"
    submissions ||--o{ reactions : "r√©actions sur"
    comments ||--o{ reactions : "r√©actions sur"
    global_prompts ||--o{ prompt_tag_links : "tagg√©"
    group_prompts ||--o{ prompt_tag_links : "tagg√©"
    prompt_tags ||--o{ prompt_tag_links : "tag"
```

### üì± Notifications & Pr√©f√©rences

```mermaid
erDiagram
    profiles ||--o{ user_devices : "appareils"
    profiles ||--o{ user_group_prefs : "pr√©f√©rences"
    groups ||--o{ user_group_prefs : "pour groupe"
    profiles ||--o{ notifications : "destinataire"
    groups ||--o{ notifications : "contexte"
```

### üìä Dictionnaire des tables

#### üë§ Utilisateurs & Groupes

| Table              | Champs principaux                                                                                   | Contraintes                         |
| ------------------ | --------------------------------------------------------------------------------------------------- | ----------------------------------- |
| **profiles**       | `id` (=auth), `display_name`, `image_path`                                                          | Li√© √† auth.users (Google)           |
| **groups**         | `name`, `type` (friends\|couple), `owner_id`, `timezone`, `join_enabled`, `join_code`, `image_path` | `owner_id` ‚Üí profiles, owner unique |
| **group_members**  | `group_id`, `user_id`, `role` (owner\|admin\|member)                                                | UNIQUE(group_id, user_id)           |
| **group_settings** | `group_id`, `drop_time`, `close_after_hours`, `notifications_enabled`                               | 1:1 avec groups                     |

#### üéØ Prompts & Manches

| Table                  | Champs principaux                                                                                                                                                                 | Contraintes                                                            |
| ---------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- |
| **global_prompts**     | `type` (question\|vote\|challenge), `title`, `body`, `status` (pending\|approved\|rejected\|archived), `created_by`, `reviewed_by`, `reviewed_at`, `feedback`, `metadata` (jsonb) | Banque globale curat√©e, seuls les 'approved' sont visibles aux groupes |
| **group_prompts**      | `group_id`, `type`, `title`, `body`, `is_active`, `cloned_from_global`, `created_by`, `metadata` (jsonb)                                                                          | Prompts locaux cr√©√©s/clon√©s par owners/admins                          |
| **prompt_suggestions** | `group_prompt_id`, `suggested_by`, `status` (pending\|approved\|rejected), `feedback`                                                                                             | Suggestions de prompts locaux ‚Üí globaux                                |
| **daily_rounds**       | `group_id`, `global_prompt_id`, `group_prompt_id`, `scheduled_for`, `status` (scheduled\|open\|closed)                                                                            | UNIQUE(group_id, scheduled_for), utilise soit global soit group prompt |
| **submissions**        | `round_id`, `author_id`, `content_text`                                                                                                                                           | UNIQUE(round_id, author_id)                                            |

#### üí¨ Interactions

| Table           | Champs principaux                        | Contraintes                                     |
| --------------- | ---------------------------------------- | ----------------------------------------------- |
| **comments**    | `round_id`, `author_id`, `body`          | Discussion globale sur la question du jour      |
| **round_votes** | `round_id`, `voter_id`, `target_user_id` | UNIQUE(round_id, voter_id), CHECK(voter‚â†target) |

#### üîî Notifications

| Table                | Champs principaux                      | Contraintes                               |
| -------------------- | -------------------------------------- | ----------------------------------------- |
| **notifications**    | `user_id`, `type`, `payload`, `status` | Types: round_open, round_close_soon, etc. |
| **user_devices**     | `user_id`, `platform`, `token`         | Pour push notifications                   |
| **user_group_prefs** | `user_id`, `group_id`, `mute`, `push`  | UNIQUE(user_id, group_id)                 |

### ‚öñÔ∏è Contraintes m√©tier

#### üéØ R√®gles de participation

| Contrainte                        | Description                                  | Impl√©mentation                                                    |
| --------------------------------- | -------------------------------------------- | ----------------------------------------------------------------- |
| **1 round/jour/groupe**           | Unicit√© quotidienne                          | `UNIQUE(group_id, scheduled_for)`                                 |
| **1 soumission/user/round**       | Une participation par manche, pas d'√©dition  | `UNIQUE(round_id, author_id)`                                     |
| **Suppression = nouvelle chance** | Supprimer lib√®re le quota pour re-soumission | Suppression possible uniquement pendant round ouvert              |
| **1 vote/user/round**             | Vote unique, pas d'auto-vote                 | `UNIQUE(round_id, voter_id)` + `CHECK(voter_id ‚â† target_user_id)` |
| **Visibilit√© imm√©diate**          | Pas de mode "blind"                          | Soumissions visibles d√®s publication                              |
| **Visibilit√© conditionnelle**     | Interactions apr√®s soumission                | Commentaires/votes visibles apr√®s avoir soumis sa r√©ponse         |

#### üîê R√®gles de s√©curit√©

- **Appartenance stricte** : Toute action requiert membership du groupe
- **Owner unique** : Exactement 1 owner par groupe, non r√©voquable sans transfert
- **Fuseau horaire** : Planification locale, stockage UTC
- **Mod√©ration centralis√©e** : Seul le cr√©ateur de l'app (APP_CREATOR_EMAIL) peut valider les prompts
- **Prompts approuv√©s uniquement** : Les groupes ne peuvent s√©lectionner que des prompts avec status='approved'

#### üîë S√©curit√© des codes d'invitation

- **G√©n√©ration automatique** : Code cr√©√© √† la cr√©ation du groupe (6 caract√®res alphanum√©riques)
- **Permanence** : Code permanent, pas d'expiration ni de quota d'utilisation
- **Modification** : Possibilit√© de r√©g√©n√©rer un nouveau code (invalide l'ancien)
- **Stockage s√©curis√©** : Hash du code stock√© dans `groups.join_code` (SHA-256 + salt)
- **Rate limiting** : Maximum 5 tentatives de join par IP/heure
- **Activation** : Code utilisable uniquement si `join_enabled=true`

## üîî Notifications & Pr√©f√©rences

### üì® Types de notifications

| Type                 | Trigger                | Timing                    |
| -------------------- | ---------------------- | ------------------------- |
| **round_open**       | Ouverture de manche    | √Ä `open_at`               |
| **round_close_soon** | Rappel avant fermeture | √Ä `close_at - Œî` (ex: 1h) |

### ‚öôÔ∏è Syst√®me de pr√©f√©rences

```mermaid
flowchart TD
    A[Notification trigger] --> B{group_settings.notifications_enabled?}
    B -->|Non| C[Block√©]
    B -->|Oui| D{user_group_prefs.mute?}
    D -->|Oui| C
    D -->|Non| E{user_group_prefs.push?}
    E -->|Non| F[Email uniquement]
    E -->|Oui| G[Push + Email]
    G --> H[user_devices: ciblage par appareil]
    H --> I[Localisation via locale]
```

## üìã User Stories

Pour consulter toutes les user stories d√©taill√©es organis√©es par √©piques, voir : **[user-stories.md](./user-stories.md)**

Le document contient 19 √©piques couvrant :

- Authentification & Profil (Google OAuth)
- Gestion des groupes et r√¥les
- Syst√®me de prompts et manches quotidiennes
- Interactions sociales (commentaires, votes)
- Notifications et pr√©f√©rences
- S√©curit√© et int√©grit√© des donn√©es

### ‚úÖ Crit√®res d'acceptation (Gherkin)

#### Soumission unique

```gherkin
√âtant donn√© un round ouvert
Quand je publie une deuxi√®me soumission
Alors l'action √©choue avec "Une seule soumission par manche"
```

#### Vote unique & anti-auto-vote

```gherkin
√âtant donn√© un round de type "vote"
Quand je vote pour moi-m√™me
Alors l'action est rejet√©e (auto-vote interdit)
```

#### Ouverture & rappel automatiques

```gherkin
√âtant donn√© un round planifi√© pour aujourd'hui
Quand open_at est atteint
Alors le statut passe √† "open" ET une notification est √©mise

Et quand close_at - 1h est atteint ET je n'ai pas particip√©
Alors je re√ßois une notification "round_close_soon"
```

## ‚öôÔ∏è Workflow d'orchestration (Jobs)

### üîÑ Jobs automatis√©s

```mermaid
gantt
    title Cycle quotidien des jobs
    dateFormat HH:mm
    axisFormat %H:%M

    section Planification
    Cr√©ation manches J+1    :active, plan, 00:00, 00:30

    section Ex√©cution
    Ouverture manches        :active, open, 06:00, 23:00
    Rappels                  :active, remind, 06:00, 23:00
    Fermeture & archivage    :active, close, 06:00, 23:59
```

#### üìÖ Planification (quotidien, 00:00)

```sql
-- Pour chaque groupe actif sans round J+1
INSERT INTO daily_rounds (group_id, prompt_id, scheduled_for, status)
SELECT g.id, selected_prompt_id, CURRENT_DATE + 1, 'scheduled'
FROM groups g
WHERE g.is_active = true
  AND NOT EXISTS (
    SELECT 1 FROM daily_rounds dr
    WHERE dr.group_id = g.id
    AND dr.scheduled_for = CURRENT_DATE + 1
  )
```

#### üîì Ouverture (toutes les 5 min)

```sql
UPDATE daily_rounds
SET status = 'open', open_at = NOW()
WHERE status = 'scheduled'
  AND scheduled_for <= CURRENT_DATE
  AND EXTRACT(hour FROM NOW()) >= EXTRACT(hour FROM drop_time)
```

#### ‚è∞ Rappels (toutes les 10 min)

```sql
-- Notifier les non-participants avant fermeture
INSERT INTO notifications (user_id, group_id, type, payload)
SELECT gm.user_id, dr.group_id, 'round_close_soon', '{}'
FROM daily_rounds dr
JOIN group_members gm ON dr.group_id = gm.group_id
WHERE dr.status = 'open'
  AND dr.close_at - NOW() <= INTERVAL '1 hour'
  AND NOT EXISTS (SELECT 1 FROM submissions s WHERE s.round_id = dr.id AND s.author_id = gm.user_id)
```

#### üîí Fermeture & Archivage (toutes les 5 min)

```sql
-- Transition: open ‚Üí closed (√©tat final)
UPDATE daily_rounds
SET status = 'closed', close_at = NOW()
WHERE status = 'open' AND close_at <= NOW();

-- Les soumissions, commentaires et votes sont fig√©s
-- La manche reste consultable ind√©finiment
```

### üîí Garanties d'int√©grit√©

- **Idempotence** : Cl√©s uniques + transitions strictes
- **Concurrence** : Advisory locks par `group_id` si n√©cessaire
- **Monitoring** : Logs des transitions de statut

## üé® Parcours UX prioritaires

### üöÄ Onboarding (< 2 min)

```mermaid
flowchart LR
    A[üì± Install] --> B{Premier usage?}
    B -->|Oui| C[üÜï Cr√©er groupe]
    B -->|Non| D[üî¢ Code d'invitation]
    C --> E[‚öôÔ∏è Config rapide]
    D --> E
    E --> F[üéâ Pr√™t !]
```

### üè† √âcran principal "Aujourd'hui"

#### **Avant de soumettre sa r√©ponse :**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üéØ PROMPT DU JOUR                    ‚îÇ
‚îÇ  "Quel est votre super-pouvoir r√™v√©?"   ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  [ ‚úçÔ∏è R√©pondre ]     ‚è∞ Ferme √† 20h00     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üîí Contenu masqu√©                     ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  Soumettez votre r√©ponse pour voir :   ‚îÇ
‚îÇ  ‚Ä¢ Les r√©ponses des autres membres     ‚îÇ
‚îÇ  ‚Ä¢ La discussion du groupe             ‚îÇ
‚îÇ  ‚Ä¢ Les votes (si applicable)           ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üë• 3 membres ont d√©j√† particip√©        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### **Apr√®s avoir soumis sa r√©ponse :**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üéØ PROMPT DU JOUR                    ‚îÇ
‚îÇ  "Quel est votre super-pouvoir r√™v√©?"   ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  ‚úÖ Votre r√©ponse: "T√©l√©portation!"     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üìù SOUMISSIONS (temps r√©el)           ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üë§ Alice: "Lire dans les pens√©es!"    ‚îÇ
‚îÇ  üë§ Bob: "Voler comme Superman"       ‚îÇ
‚îÇ  üë§ Vous: "T√©l√©portation!"            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üó≥Ô∏è VOTES (si applicable)              ‚îÇ
‚îÇ  üë§ Alice: 2 votes                    ‚îÇ
‚îÇ  üë§ Bob: 1 vote                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üí¨ DISCUSSION GLOBALE                 ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üë§ Alice: "Excellent choix Bob!"      ‚îÇ
‚îÇ  üë§ Charlie: "Moi j'h√©site encore..."  ‚îÇ
‚îÇ  [ üí¨ Ajouter un commentaire ]         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üìö Round archiv√© (Consultation)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìö MANCHE D'HIER - Ferm√©e             ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üë§ Bob: "Voler comme Superman"       ‚îÇ
‚îÇ  üí¨ 3 commentaires                    ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üë§ Alice: "Lire dans les pens√©es!"    ‚îÇ
‚îÇ  üí¨ 2 commentaires                    ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üë§ Charlie: "T√©l√©portation!"         ‚îÇ
‚îÇ  üí¨ 1 commentaire                     ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üìä 3 participants, 6 commentaires     ‚îÇ
‚îÇ  üì∏ 2 m√©dias partag√©s                 ‚îÇ
‚îÇ  üîí Ferm√©e - Lecture seule             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### ‚öôÔ∏è √âcrans secondaires

- **R√©glages groupe** : Heure locale, dur√©e, notifications, type
- **Banque prompts** : Filtre par tags, "Choisir pour demain"
- **Historique** : Manches pass√©es consultables avec tout leur contenu

## ‚ö†Ô∏è Risques & Garde-fous

### üîí Risques techniques

| Risque                 | Impact                | Mitigation                            |
| ---------------------- | --------------------- | ------------------------------------- |
| **Concurrence jobs**   | üî¥ Corruption donn√©es | Advisory locks + transitions strictes |
| **Spam notifications** | üü° UX d√©grad√©e        | Pr√©f√©rences + `notifications_enabled` |
| **Surcharge uploads**  | üü° Performance        | Limites taille + compression          |
| **Race conditions**    | üî¥ √âtats incoh√©rents  | Transactions + contraintes DB         |

### üõ°Ô∏è Risques produit

| Risque                   | Impact                   | Mitigation                                |
| ------------------------ | ------------------------ | ----------------------------------------- |
| **Contenus sensibles**   | üü° Mod√©ration n√©cessaire | Suppression owner/admin (v1)              |
| **Fatigue prompts**      | üü° Engagement baisse     | S√©lection diversifi√©e + banque croissante |
| **Groupes inactifs**     | üü¢ Ressources gaspill√©es | D√©tection + archivage auto                |
| **Abandon utilisateurs** | üü° R√©tention faible      | Onboarding optimis√© + notifications       |

### üìä Monitoring & Alertes

- **M√©triques core** : Participation quotidienne, temps de r√©ponse jobs
- **Alertes** : √âchecs jobs, pics d'erreurs, goulets d'√©tranglement
- **Dashboards** : Sant√© syst√®me, usage utilisateurs, performance

## üìö Glossaire

### üéØ Termes m√©tier

| Terme          | D√©finition                                       | Exemple                                   |
| -------------- | ------------------------------------------------ | ----------------------------------------- |
| **Prompt**     | Consigne quotidienne (question, vote, challenge) | "Quel est votre plat pr√©f√©r√© ?"           |
| **Round**      | Manche quotidienne d'un groupe                   | Round du 04/01/2025 pour "Les Copains"    |
| **Soumission** | R√©ponse d'un membre au prompt                    | Texte + image en r√©ponse                  |
| **Archivage**  | Consultation des manches ferm√©es                 | Toutes les contributions restent visibles |

### üë• R√¥les & Permissions

| R√¥le            | Permissions                                                                        | Contraintes                                         |
| --------------- | ---------------------------------------------------------------------------------- | --------------------------------------------------- |
| **App Creator** | Mod√©ration banque globale + administration syst√®me + acc√®s exclusif banque globale | Email d√©fini dans .env, seul acc√®s interface admin  |
| **Owner**       | Gestion groupe + gestion prompts locaux + suggestions (PAS d'acc√®s banque globale) | Unique par groupe, non r√©voquable sans transfert    |
| **Admin**       | Gestion prompts locaux + s√©lection + membres (PAS d'acc√®s banque globale)          | Nomm√© par owner                                     |
| **Member**      | Participation + interactions + suggestion prompts locaux vers globaux              | R√¥le par d√©faut, aucun acc√®s aux banques de prompts |

### üì± Interactions

| Type             | Description                   | Symboles                      |
| ---------------- | ----------------------------- | ----------------------------- |
| **Commentaires** | Discussion libre              | Texte libre                   |
| **Votes**        | Choix dans les prompts "vote" | 1 vote/round, pas d'auto-vote |

## üóìÔ∏è Roadmap Approche Hybride

### üöÄ Phase 1 - Fondations hybrides

- [x] S√©parer prompts globaux et locaux dans le mod√®le de donn√©es
- [ ] Interface de d√©couverte des prompts globaux (liste + tags + filtres)
- [ ] Fonctionnalit√© de clonage vers prompts locaux
- [ ] Cr√©ation directe de prompts locaux par owners/admins
- [ ] Starter pack de prompts globaux approuv√©s

### üéØ Phase 2 - Exp√©rience utilisateur

- [ ] Filtrage avanc√© (tags, langue, difficult√©, type de groupe)
- [ ] √âdition locale des prompts clon√©s
- [ ] Interface de gestion des prompts locaux
- [ ] S√©lection intelligente (mix global/local)
- [ ] Preview des prompts avant s√©lection

### üåü Phase 3 - Contributions communautaires

- [ ] Syst√®me de suggestions (prompt local ‚Üí global)
- [ ] Interface de mod√©ration pour l'app creator
- [ ] Analytics sur les prompts populaires
- [ ] Workflow d'approbation avec feedback
- [ ] Historique des contributions

### üîÆ Phase 4 - Intelligence & Personnalisation

- [ ] Recommandations bas√©es sur l'historique du groupe
- [ ] D√©tection automatique des prompts locaux r√©ussis
- [ ] Suggestions proactives de conversion vers global
- [ ] Analytics avanc√©s pour l'app creator
- [ ] API pour contributions externes
